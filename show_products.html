<!DOCTYPE html>
<html>
<head>
    <title>Список товаров</title>
    <style>
        table {
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #dddddd;
            text-align: left;
            padding: 8px;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Список товаров</h1>
    <div style= "padding: 5px;">
    <button onclick="window.location.href = `new_product.html`">Создать Товар</button>
    </div>
    <table>
        <thead>
            <tr>
                <th>Код товара</th>
                <th>Название товара</th>
                <th>Рекомендуемая цена</th>
                <th>Действие</th>
            </tr>
        </thead>
        <tbody id="json-data">
            <!-- Здесь будут отображаться данные JSON -->
        </tbody>
    </table>

    <script>
        // Функция для выполнения запроса к серверу Flask
        function fetchData() {
            fetch('http://127.0.0.1:5000/get_products') // Замените '/api/data' на путь к вашему Flask-маршруту
                .then(response => response.json())
                .then(data => {
                    // Отображение полученных данных JSON на странице
                    const jsonDataElement = document.getElementById('json-data');
                    jsonDataElement.innerHTML = '';

                    for (const item of data) {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${item.product_code}</td>
                            <td>${item.product_name}</td>
                            <td>${item.rec_price}</td>
                            <td class="button-container">
                                <button onclick="openProduct(${item.id})">Открыть</button>
                                <button onclick="deleteProduct(${item.id})">Удалить</button>
                            </td>
                        `;
                        jsonDataElement.appendChild(row);
                    }
                })
                .catch(error => {
                    console.error('Ошибка при выполнении запроса:', error);
                });
        }
        
        function openProduct(productId) {
            window.location.href = `edit_product.html?id=${productId}`;
        }

        // Функция для удаления продукта
        function deleteProduct(productId) {
            // Ваш код для удаления продукта
            alert('Удаляю продукт с ID ' + productId);
            window.location.href = `http://127.0.0.1:5000/del_product?id=${productId}`;
        }

        // Вызываем функцию для получения данных при загрузке страницы
        window.addEventListener('load', fetchData);
    </script>
</body>
</html>
